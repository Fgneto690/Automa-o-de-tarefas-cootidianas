{"files":[{"id":"42f123ee-6513-47d8-bca6-440e58948e66","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Sao_Paulo\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"fde8599b-82cf-4f92-8f98-e86129b18625","name":"Código","type":"server_js","source":"function organizarArquivosAntigosXlsx() {\n  const PASTAS_ORIGEM_IDS \u003d [\n    \"Id-Pasta\"\n// Adicione os IDs das pastas aqui\n  ];\n  const DATA_LIMITE \u003d new Date(2024, 11, 3); // Mês é 0-indexado (11 \u003d dezembro)\n\n  PASTAS_ORIGEM_IDS.forEach((idPastaOrigem) \u003d\u003e {\n    const pastaOrigem \u003d DriveApp.getFolderById(idPastaOrigem);\n    const pastaDestino \u003d getOrCreateSubfolder(pastaOrigem, \"Busca Ativa Anteriores\");\n\n    // Coleta todos os arquivos .xlsx anteriores à data limite\n    const arquivosParaMover \u003d [];\n    const arquivos \u003d pastaOrigem.getFiles();\n    while (arquivos.hasNext()) {\n      const arquivo \u003d arquivos.next();\n      const dataCriacao \u003d arquivo.getDateCreated();\n      const nomeArquivo \u003d arquivo.getName();\n\n      if (nomeArquivo.endsWith(\".xlsx\") \u0026\u0026 dataCriacao \u003c DATA_LIMITE) {\n        arquivosParaMover.push(arquivo);\n      }\n    }\n\n    // Processa cada arquivo fora do loop principal\n    arquivosParaMover.forEach((arquivo) \u003d\u003e {\n      try {\n        // Move o arquivo para a subpasta de destino\n        arquivo.moveTo(pastaDestino);\n        Logger.log(`Arquivo movido: ${arquivo.getName()} para ${pastaDestino.getName()}`);\n      } catch (e) {\n        Logger.log(`Erro ao mover o arquivo ${arquivo.getName()}: ${e.message}`);\n      }\n    });\n  });\n}\n\n// Função auxiliar para criar ou obter uma subpasta\nfunction getOrCreateSubfolder(parentFolder, subfolderName) {\n  const subfolders \u003d parentFolder.getFoldersByName(subfolderName);\n  if (subfolders.hasNext()) {\n    return subfolders.next();\n  } else {\n    return parentFolder.createFolder(subfolderName);\n  }\n}\n"}]}